{% load i18n %}
{% load pba_tags %}

<div id="petitions">
    <h2>{{ petition.title }}</h2>
    
    <div class="petition">
        {# Only show form if campaign is not completed #}
        {% if page.status != "completed" and petition.active %}
            {# Use the Wagtail-specific petition form template #}
            {% include 'campaigns/blocks/petition_form.html' with petition=petition form=petition.form page=page %}
        {% else %}
            {# For completed campaigns or inactive petitions, just show the letter #}
            {% if petition.letter %}
                <p>{{ petition.letter|linebreaks }}</p>
            {% endif %}
        {% endif %}
    </div>
</div>

{# Signatures display if enabled #}
{% if petition.show_submissions %}
    <div class="fade-transition" 
         hx-get="{{ page.url }}petition/{{ petition.id }}/_signatures/" 
         hx-trigger="every 10s" 
         hx-swap="innerHTML transition:true">
        {# Initial signatures will be loaded here #}
        {% include 'campaigns/_partial_signatures.html' with petition=petition %}
    </div>
{% endif %}